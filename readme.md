# Тестовое задание на PHP ООП 

_Kenner Soft Service GmbH v27/01/2021_

Тестовое задание необходимо сопроводить краткими комментариями, почему именно так сделали.

Результаты должны быть представлены на GitHub. Перед началом работы запушить 
пустой файл (чтобы видеть начало работы над (тестовым), затем результат через час
промежуточный, а затем конечный результат)

Есть завод который создает роботов, каждый тип роботов имеет вес, скорость, высоту. 
Несколько роботов могут объединяться в один робот. Результирующая скорость работа 
будет равняться минимальной из всех объединенных роботов, вес и высота будут равны
сумме всех весов и высот каждого из роботов соответственно.

Нужно спроектировать классы так, чтобы можно было просто добавлять к заводу другой
тип роботов и создавать любое количество этих роботов.

Пример использования:
```
$factory = new FactoryRobot();
```

//Добавления типов Robot1, Robot2 роботов которые создает фабрика
```
$factory->addType(new Robot1());
$factory->addType(new Robot2());
```

* Результатом работы метода createRobot1 будет массив из 5 объектов класса Robot1
* Результатом работы метода createRobot2 будет массив из 2 объектов класса Robot2

```
var_dump($factory->createRobot1(5)); 
var_dump($factory->createRobot2(2));
```
  
Объединение роботов в один
```
  $mergeRobot = new MergeRobot();
  $mergeRobot->addRobot(new Robot2());
  $mergeRobot->addRobot($factory->createRobot2(2));
  $factory->addType($mergeRobot );
  $res = reset($factory->createMergeRobot(1));
```

// Результатом работы метода будет минимальная скорость из всех объединенных роботов
```
echo $res->getSpeed();
```

// Результатом работы метода будет сумма всех весов объединенных роботов
```
echo $res->getWeight();
```

## Решение

> Это версия 2.0. Предыдущая версия находится в ветке v1.

Запуск: `php main.php` (нужен PHP 8.4)

Проектировал код так, чтобы легко добавлять новые типы роботов и создавать их в любом количестве.

Создал интерфейс IRobot, который определяет все методы, нужные для работы с роботом - тип, вес, скорость, высота. Это позволяет MergeRobot работать с любым роботом одинаково, независимо от его конкретного класса.

AbstractRobot сделал readonly, потому что характеристики робота не должны меняться после создания. Это иммутабельные объекты.

MergeRobot реализовал как Composite - он тоже IRobot, но внутри содержит массив других роботов. Скорость считается как минимум из всех (самый медленный ограничивает всю группу), а вес и высота суммируются. Каждый MergeRobot имеет свой type - либо автоматически генерируется (merge_robot_1, merge_robot_2), либо можно задать явно. Это позволяет регистрировать в фабрике несколько разных мерж-роботов.

FactoryRobot работает через прототипы. Когда добавляешь тип через addType(), фабрика запоминает этот экземпляр как образец. При вызове create() она просто клонирует его нужное количество раз. Идентификация идет по getType(), а не по имени класса. Это важно - так можно создавать типы роботов динамически, без отдельных классов. Просто наследуешься от AbstractRobot, передаешь свои характеристики и type - и готово.

Отказался от магических методов вроде createRobot1(5). Вместо этого явный метод create('robot1', 5). Так понятнее и легче отлаживать.

Можно еще улучшить, автозагрузчик, при интенсивной нагрузке можно кэшировать геттеры в мерж-роботах